<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ğŸŒŠ ç°¡å–®æ¸¬è©¦ç‰ˆ</title>
    <style>
        body { margin: 0; padding: 0; background: #000; overflow: hidden; font-family: Arial, sans-serif; }
        #canvas { 
            width: 100vw; height: 100vh; display: block; outline: none; 
            touch-action: none;
        }
        #info {
            position: fixed; top: 15px; left: 15px; color: white;
            background: rgba(0,0,0,0.8); padding: 15px; border-radius: 8px;
            font-size: 13px; z-index: 100;
        }
    </style>
</head>
<body>
    <canvas id="canvas"></canvas>
    
    <div id="info">
        <div><strong>ğŸŒŠ ç°¡å–®æ¸¬è©¦ç‰ˆ</strong></div>
        <div>ç‹€æ…‹: <span id="status">åˆå§‹åŒ–ä¸­...</span></div>
        <div>ç‰ˆæœ¬: <span id="version">--</span></div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/babylonjs@6.0.0/babylon.js"></script>
    <script>
        let engine, scene, camera;
        
        function updateStatus(text) {
            document.getElementById('status').textContent = text;
            console.log('ğŸ“Š ç‹€æ…‹: ' + text);
        }
        
        function updateVersion() {
            if (BABYLON && BABYLON.Engine && BABYLON.Engine.Version) {
                document.getElementById('version').textContent = BABYLON.Engine.Version;
            }
        }

        async function init() {
            try {
                updateStatus('æª¢æŸ¥ç’°å¢ƒ...');
                console.log('ğŸ” BABYLON å°è±¡:', typeof BABYLON);
                console.log('ğŸ” ArcRotateCamera:', typeof BABYLON.ArcRotateCamera);
                updateVersion();
                
                updateStatus('å‰µå»ºå¼•æ“...');
                const canvas = document.getElementById('canvas');
                engine = new BABYLON.Engine(canvas, true);
                console.log('âœ… å¼•æ“å‰µå»ºæˆåŠŸ');
                
                updateStatus('å‰µå»ºå ´æ™¯...');
                scene = new BABYLON.Scene(engine);
                scene.clearColor = new BABYLON.Color3(0.1, 0.15, 0.2);
                console.log('âœ… å ´æ™¯å‰µå»ºæˆåŠŸ');
                
                updateStatus('è¨­ç½®ç›¸æ©Ÿ...');
                // ä½¿ç”¨æ­£ç¢ºçš„ Babylon.js v6.0.0 API
                camera = new BABYLON.ArcRotateCamera(
                    "camera", 
                    0,                       // alpha
                    Math.PI / 3,            // beta
                    30,                     // radius
                    BABYLON.Vector3.Zero(), // target
                    scene                   // scene (å¿…é ˆ)
                );
                
                // è¨­ç½®ç‚ºæ´»å‹•ç›¸æ©Ÿ
                scene.activeCamera = camera;
                
                // ä½¿ç”¨æ­£ç¢ºçš„ attachControl æ–¹æ³•
                camera.attachControl(canvas, false);
                console.log('âœ… ç›¸æ©Ÿæ§åˆ¶é™„åŠ æˆåŠŸ');
                
                updateStatus('æ·»åŠ å…‰ç…§...');
                const light = new BABYLON.HemisphericLight("light", new BABYLON.Vector3(0, 1, 0), scene);
                light.intensity = 0.7;
                console.log('âœ… å…‰ç…§æ·»åŠ æˆåŠŸ');
                
                updateStatus('å‰µå»ºç‰©é«”...');
                // å‰µå»ºä¸€å€‹ç°¡å–®çš„æ°´é¢
                const ground = BABYLON.MeshBuilder.CreateGround("ground", {width: 50, height: 50}, scene);
                const groundMat = new BABYLON.StandardMaterial("groundMat", scene);
                groundMat.diffuseColor = new BABYLON.Color3(0.2, 0.4, 0.6);
                groundMat.alpha = 0.8;
                ground.material = groundMat;
                
                // å‰µå»ºå¹¾å€‹æ¸¬è©¦æ°´ç‡ˆ
                for (let i = 0; i < 5; i++) {
                    const sphere = BABYLON.MeshBuilder.CreateSphere(`sphere${i}`, {diameter: 2}, scene);
                    sphere.position.x = (Math.random() - 0.5) * 20;
                    sphere.position.y = 1;
                    sphere.position.z = (Math.random() - 0.5) * 20;
                    
                    const mat = new BABYLON.StandardMaterial(`mat${i}`, scene);
                    mat.diffuseColor = new BABYLON.Color3(1, 0.8, 0.4);
                    mat.emissiveColor = new BABYLON.Color3(0.3, 0.2, 0.1);
                    sphere.material = mat;
                    
                    // ç°¡å–®å‹•ç•«
                    const startTime = Math.random() * 1000;
                    scene.registerBeforeRender(() => {
                        sphere.position.y = 1 + Math.sin(Date.now() * 0.002 + startTime) * 0.3;
                        sphere.rotation.y += 0.005;
                    });
                }
                console.log('âœ… æ¸¬è©¦ç‰©é«”å‰µå»ºæˆåŠŸ');
                
                updateStatus('å•Ÿå‹•æ¸²æŸ“...');
                engine.runRenderLoop(() => {
                    scene.render();
                });
                
                // éŸ¿æ‡‰å¼
                window.addEventListener('resize', () => {
                    engine.resize();
                });
                
                updateStatus('é‹è¡Œä¸­ âœ…');
                console.log('ğŸ‰ ç°¡å–®æ¸¬è©¦ç‰ˆå•Ÿå‹•æˆåŠŸï¼');
                
            } catch (error) {
                updateStatus('å¤±æ•— âŒ');
                console.error('âŒ åˆå§‹åŒ–å¤±æ•—:', error);
                console.error('éŒ¯èª¤å †æ£§:', error.stack);
                
                // é¡¯ç¤ºéŒ¯èª¤
                const errorDiv = document.createElement('div');
                errorDiv.style.cssText = `
                    position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%);
                    background: rgba(255, 0, 0, 0.9); color: white; padding: 20px;
                    border-radius: 10px; z-index: 1000; max-width: 80%;
                `;
                errorDiv.innerHTML = `
                    <h3>âŒ åˆå§‹åŒ–å¤±æ•—</h3>
                    <p><strong>éŒ¯èª¤:</strong> ${error.message}</p>
                    <p><strong>API ç‰ˆæœ¬:</strong> ${BABYLON.Engine ? BABYLON.Engine.Version : 'unknown'}</p>
                    <button onclick="location.reload()" style="
                        background: white; color: red; border: none;
                        padding: 10px 20px; border-radius: 5px; cursor: pointer;
                        margin-top: 10px;
                    ">é‡è©¦</button>
                `;
                document.body.appendChild(errorDiv);
            }
        }
        
        // å•Ÿå‹•
        document.addEventListener('DOMContentLoaded', init);
    </script>
</body>
</html>